# Bring up infrastructure

Start by bringing up the infrastructure using:

`docker-compose up -d`

It spins up the following components:
* 1 kafka instance: message broker
* 1 zookeeper instance: required by kafka
* 1 elasticsearch instance: datastore
* 1 logstash instance: event persister
* 1 sinatra instance: REST API

# Generate historical data

Dummy historical data can be generated by running the `load_historical_data.rb` ruby script.

First ensure ruby is installed https://www.ruby-lang.org/en/downloads/

## Install gems
`bundle install --path vendor/path`

## Generate data

`bundle exec ruby load_historical_data.rb`

The ouput of this script contains the randomly generated clientIds populated.


## Call service

Finally you can call the `getGender`endpoint for the `769c82c0-9202-41fb-b21e-6c9e5ef14c10` clientID:

http://localhost:4567/getGender/769c82c0-9202-41fb-b21e-6c9e5ef14c10